AnalysisType: rule
DisplayName: "GitHub Dependabot Vulnerability Dismissed" 
Enabled: true
Filename: github_repo_vulnerability_dismissed.py
RuleID: "Github.Repo.VulnerabilityDismissed"
Severity: High
Threshold: 1
Description: >
  Creates an alert if a dependabot alert is dismissed without being fixed.
LogTypes:
  - GitHub.Audit
Tests:
  - Name: GitHub Dependabot Vulnerability Dismissed
    LogType: GitHub.Audit
    ExpectedResult: true
    Log:
      {
        "action": "repository_vulnerability_alert.dismiss",
        "alert_number": 1, 
        "repo": "panther-labs/panther-analysis",
      }
  - Name: Not GitHub Dependabot Vulnerability Dismissed
    LogType: GitHub.Audit
    ExpectedResult: false
    Log: 
      { 
        "action": "not_repository_vulnerability_alert.dismiss", 
      }
